
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{text\_classification}
    
    
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{k+kn}{import} \PY{n+nn}{sys}
         \PY{k+kn}{import} \PY{n+nn}{nltk}
         \PY{k+kn}{import} \PY{n+nn}{sklearn}\PY{o}{,} \PY{n+nn}{pandas} \PY{k+kn}{as} \PY{n+nn}{pd}\PY{o}{,} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{c+c1}{\PYZsh{}load the dataset of sms msgs}
         \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}table}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SMSSpamCollection}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{header} \PY{o}{=} \PY{n+nb+bp}{None}\PY{p}{,}\PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{k}{print}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 5572 entries, 0 to 5571
Data columns (total 2 columns):
0    5572 non-null object
1    5572 non-null object
dtypes: object(2)
memory usage: 43.6+ KB
None
------------------

      0                                                  1
0   ham  Go until jurong point, crazy.. Available only {\ldots}
1   ham                      Ok lar{\ldots} Joking wif u oni{\ldots}
2  spam  Free entry in 2 a wkly comp to win FA Cup fina{\ldots}
3   ham  U dun say so early hor{\ldots} U c already then say{\ldots}
4   ham  Nah I don't think he goes to usf, he lives aro{\ldots}

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{c+c1}{\PYZsh{}check class distr\PYZhy{}n}
         \PY{n}{classes} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{k}{print}\PY{p}{(}\PY{n}{classes}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
ham     4825
spam     747
Name: 0, dtype: int64

    \end{Verbatim}

    \subsection{2. Preprocess the data}\label{preprocess-the-data}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{c+c1}{\PYZsh{}convert class lables to  binary values , 0,1}
         \PY{k+kn}{from} \PY{n+nn}{sklearn.preprocessing} \PY{k+kn}{import}  \PY{n}{LabelEncoder}
         \PY{n}{encoder} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
         \PY{n}{Y} \PY{o}{=} \PY{n}{encoder}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{classes}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{k}{print}\PY{p}{(}\PY{n}{Y}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[0 0 1 0 0 1 0 0 1 1]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:}  \PY{c+c1}{\PYZsh{}store the sms msgs data}
         \PY{n}{text\PYZus{}messages} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{c+c1}{\PYZsh{} 2nd column \PYZhy{} the actual smski!}
         \PY{k}{print}\PY{p}{(}\PY{n}{text\PYZus{}messages}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
0    Go until jurong point, crazy.. Available only {\ldots}
1                        Ok lar{\ldots} Joking wif u oni{\ldots}
2    Free entry in 2 a wkly comp to win FA Cup fina{\ldots}
3    U dun say so early hor{\ldots} U c already then say{\ldots}
4    Nah I don't think he goes to usf, he lives aro{\ldots}
5    FreeMsg Hey there darling it's been 3 week's n{\ldots}
6    Even my brother is not like to speak with me. {\ldots}
7    As per your request 'Melle Melle (Oru Minnamin{\ldots}
8    WINNER!! As a valued network customer you have{\ldots}
9    Had your mobile 11 months or more? U R entitle{\ldots}
Name: 1, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{c+c1}{\PYZsh{}use reg exp to replace emails, urls, phones other numbers, symbols}
         \PY{c+c1}{\PYZsh{}replace email adress with \PYZsq{}emailaddr\PYZsq{}}
         \PY{n}{processed} \PY{o}{=} \PY{n}{text\PYZus{}messages}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZca{}.+@[\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{.].*}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{.[a\PYZhy{}z]\PYZob{}2,\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{emailaddr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{processed} \PY{o}{=} \PY{n}{processed}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZca{}http}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{://[a\PYZhy{}zA\PYZhy{}Z0\PYZhy{}9}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{.]+}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{.[a\PYZhy{}zA\PYZhy{}Z]\PYZob{}2,3\PYZcb{}(/}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{S*)?\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{webaddress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{processed} \PY{o}{=} \PY{n}{processed}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{£|}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{moneysymb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}replace 10digit phone number with \PYZsq{}phonenumber\PYZsq{}}
         \PY{n}{processed} \PY{o}{=} \PY{n}{processed}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{(?[}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d]\PYZob{}3\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{)?[s}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{\PYZhy{}]?[}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d]\PYZob{}3\PYZcb{}[}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{s\PYZhy{}]?[}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d]\PYZob{}4\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phonenumber}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}replace normal number with \PYZsq{}number\PYZsq{}}
         \PY{n}{processed} \PY{o}{=} \PY{n}{processed}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d+(}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d+)?}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{number}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{processed} \PY{o}{=} \PY{n}{processed}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{s]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{processed} \PY{o}{=} \PY{n}{processed}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{s+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{processed} \PY{o}{=} \PY{n}{processed}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{s+|}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{s+?\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{processed} \PY{o}{=} \PY{n}{processed}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{k}{print}\PY{p}{(}\PY{n}{processed}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
0       go until jurong point crazy available only in {\ldots}
1                                 ok lar joking wif u oni
2       free entry in number a wkly comp to win fa cup{\ldots}
3             u dun say so early hor u c already then say
4       nah i don t think he goes to usf he lives arou{\ldots}
5       freemsg hey there darling it s been number wee{\ldots}
6       even my brother is not like to speak with me t{\ldots}
7       as per your request melle melle oru minnaminun{\ldots}
8       winner as a valued network customer you have b{\ldots}
9       had your mobile number months or more u r enti{\ldots}
10      i m gonna be home soon and i don t want to tal{\ldots}
11      six chances to win cash from number to number {\ldots}
12      urgent you have won a number week free members{\ldots}
13      i ve been searching for the right words to tha{\ldots}
14                      i have a date on sunday with will
15      xxxmobilemovieclub to use your credit click th{\ldots}
16                                 oh k i m watching here
17      eh u remember how number spell his name yes i {\ldots}
18      fine if that s the way u feel that s the way i{\ldots}
19      england v macedonia dont miss the goals team n{\ldots}
20               is that seriously how you spell his name
21      i m going to try for number months ha ha only {\ldots}
22           so pay first lar then when is da stock comin
23      aft i finish my lunch then i go str down lor a{\ldots}
24      ffffffffff alright no way i can meet up with y{\ldots}
25      just forced myself to eat a slice i m really n{\ldots}
26                          lol your always so convincing
27      did you catch the bus are you frying an egg di{\ldots}
28      i m back amp we re packing the car now i ll le{\ldots}
29      ahhh work i vaguely remember that what does it{\ldots}
                              {\ldots}                        
5542             armand says get your ass over to epsilon
5543                u still havent got urself a jacket ah
5544    i m taking derek amp taylor to walmart if i m {\ldots}
5545        hi its in durban are you still on this number
5546             ic there are a lotta childporn cars then
5547    had your contract mobile number mnths latest m{\ldots}
5548                     no i was trying it all weekend v
5549    you know wot people wear t shirts jumpers hat {\ldots}
5550            cool what time you think you can get here
5551    wen did you get so spiritual and deep that s g{\ldots}
5552    have a safe trip to nigeria wish you happiness{\ldots}
5553                           hahaha use your brain dear
5554    well keep in mind i ve only got enough gas for{\ldots}
5555    yeh indians was nice tho it did kane me off a {\ldots}
5556    yes i have so that s why u texted pshew missin{\ldots}
5557    no i meant the calculation is the same that lt{\ldots}
5558                                sorry i ll call later
5559    if you aren t here in the next lt gt hours imm{\ldots}
5560                      anything lor juz both of us lor
5561    get me out of this dump heap my mom decided to{\ldots}
5562    ok lor sony ericsson salesman i ask shuhui the{\ldots}
5563                              ard number like dat lor
5564    why don t you wait til at least wednesday to s{\ldots}
5565                                            huh y lei
5566    reminder from onumber to get number pounds fre{\ldots}
5567    this is the numbernd time we have tried number{\ldots}
5568                    will b going to esplanade fr home
5569    pity was in mood for that so any other suggest{\ldots}
5570    the guy did some bitching but i acted like i d{\ldots}
5571                            rofl its true to its name
Name: 1, Length: 5572, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{c+c1}{\PYZsh{}remove the stopwords from txt msgs}
         \PY{k+kn}{from} \PY{n+nn}{nltk.corpus} \PY{k+kn}{import} \PY{n}{stopwords}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{sw} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{processed} \PY{o}{=} \PY{n}{processed}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{term} \PY{k}{for} \PY{n}{term} \PY{o+ow}{in} \PY{n}{x}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{term} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{sw}\PY{p}{)}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{n}{processed}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
0       go jurong point crazy available bugis n great {\ldots}
1                                 ok lar joking wif u oni
2       free entry number wkly comp win fa cup final t{\ldots}
3                     u dun say early hor u c already say
4                  nah think goes usf lives around though
5       freemsg hey darling number week word back like{\ldots}
6          even brother like speak treat like aids patent
7       per request melle melle oru minnaminunginte nu{\ldots}
8       winner valued network customer selected receiv{\ldots}
9       mobile number months u r entitled update lates{\ldots}
10      gonna home soon want talk stuff anymore tonigh{\ldots}
11      six chances win cash number number number poun{\ldots}
12      urgent number week free membership number numb{\ldots}
13      searching right words thank breather promise w{\ldots}
14                                            date sunday
15      xxxmobilemovieclub use credit click wap link n{\ldots}
16                                          oh k watching
17      eh u remember number spell name yes v naughty {\ldots}
18                             fine way u feel way gota b
19      england v macedonia dont miss goals team news {\ldots}
20                                   seriously spell name
21                   going try number months ha ha joking
22                           pay first lar da stock comin
23      aft finish lunch go str lor ard number smth lo{\ldots}
24                     ffffffffff alright way meet sooner
25      forced eat slice really hungry tho sucks mark {\ldots}
26                                  lol always convincing
27      catch bus frying egg make tea eating mom left {\ldots}
28                     back amp packing car let know room
29               ahhh work vaguely remember feel like lol
                              {\ldots}                        
5542                          armand says get ass epsilon
5543                  u still havent got urself jacket ah
5544    taking derek amp taylor walmart back time done{\ldots}
5545                               hi durban still number
5546                              ic lotta childporn cars
5547    contract mobile number mnths latest motorola n{\ldots}
5548                                     trying weekend v
5549    know wot people wear shirts jumpers hat belt k{\ldots}
5550                                  cool time think get
5551                         wen get spiritual deep great
5552    safe trip nigeria wish happiness soon company {\ldots}
5553                                hahaha use brain dear
5554    well keep mind got enough gas one round trip b{\ldots}
5555    yeh indians nice tho kane bit shud go number d{\ldots}
5556                      yes u texted pshew missing much
5557    meant calculation lt gt units lt gt school rea{\ldots}
5558                                     sorry call later
5559                      next lt gt hours imma flip shit
5560                              anything lor juz us lor
5561          get dump heap mom decided come lowes boring
5562    ok lor sony ericsson salesman ask shuhui say q{\ldots}
5563                              ard number like dat lor
5564                     wait til least wednesday see get
5565                                              huh lei
5566    reminder onumber get number pounds free call c{\ldots}
5567    numbernd time tried number contact u u number {\ldots}
5568                            b going esplanade fr home
5569                                pity mood suggestions
5570    guy bitching acted like interested buying some{\ldots}
5571                                       rofl true name
Name: 1, Length: 5572, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{c+c1}{\PYZsh{}remove word stems using porter stemmer}
         \PY{n}{ps} \PY{o}{=} \PY{n}{nltk}\PY{o}{.}\PY{n}{PorterStemmer}\PY{p}{(}\PY{p}{)}
         \PY{n}{processed} \PY{o}{=}  \PY{n}{processed}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{ps}\PY{o}{.}\PY{n}{stem}\PY{p}{(}\PY{n}{term}\PY{p}{)} \PY{k}{for}  \PY{n}{term} \PY{o+ow}{in} \PY{n}{x}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{k}{print}\PY{p}{(}\PY{n}{processed}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
0       go jurong point crazi avail bugi n great world{\ldots}
1                                   ok lar joke wif u oni
2       free entri number wkli comp win fa cup final t{\ldots}
3                     u dun say earli hor u c alreadi say
4                    nah think goe usf live around though
5       freemsg hey darl number week word back like fu{\ldots}
6           even brother like speak treat like aid patent
7       per request mell mell oru minnaminungint nurun{\ldots}
8       winner valu network custom select receivea num{\ldots}
9       mobil number month u r entitl updat latest col{\ldots}
10      gonna home soon want talk stuff anymor tonight{\ldots}
11      six chanc win cash number number number pound {\ldots}
12      urgent number week free membership number numb{\ldots}
13      search right word thank breather promis wont t{\ldots}
14                                            date sunday
15      xxxmobilemovieclub use credit click wap link n{\ldots}
16                                             oh k watch
17      eh u rememb number spell name ye v naughti mak{\ldots}
18                             fine way u feel way gota b
19      england v macedonia dont miss goal team news t{\ldots}
20                                     serious spell name
21                         go tri number month ha ha joke
22                           pay first lar da stock comin
23      aft finish lunch go str lor ard number smth lo{\ldots}
24                     ffffffffff alright way meet sooner
25      forc eat slice realli hungri tho suck mark get{\ldots}
26                                      lol alway convinc
27      catch bu fri egg make tea eat mom left dinner {\ldots}
28                        back amp pack car let know room
29                    ahhh work vagu rememb feel like lol
                              {\ldots}                        
5542                           armand say get ass epsilon
5543                  u still havent got urself jacket ah
5544    take derek amp taylor walmart back time done l{\ldots}
5545                               hi durban still number
5546                               ic lotta childporn car
5547    contract mobil number mnth latest motorola nok{\ldots}
5548                                        tri weekend v
5549    know wot peopl wear shirt jumper hat belt know{\ldots}
5550                                  cool time think get
5551                           wen get spiritu deep great
5552    safe trip nigeria wish happi soon compani shar{\ldots}
5553                                hahaha use brain dear
5554    well keep mind got enough ga one round trip ba{\ldots}
5555    yeh indian nice tho kane bit shud go number dr{\ldots}
5556                            ye u text pshew miss much
5557    meant calcul lt gt unit lt gt school realli ex{\ldots}
5558                                     sorri call later
5559                       next lt gt hour imma flip shit
5560                                 anyth lor juz us lor
5561                get dump heap mom decid come low bore
5562    ok lor soni ericsson salesman ask shuhui say q{\ldots}
5563                              ard number like dat lor
5564                     wait til least wednesday see get
5565                                              huh lei
5566    remind onumb get number pound free call credit{\ldots}
5567    numbernd time tri number contact u u number po{\ldots}
5568                                b go esplanad fr home
5569                                    piti mood suggest
5570    guy bitch act like interest buy someth els nex{\ldots}
5571                                       rofl true name
Name: 1, Length: 5572, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{k+kn}{from} \PY{n+nn}{nltk.tokenize} \PY{k+kn}{import} \PY{n}{word\PYZus{}tokenize}
         \PY{c+c1}{\PYZsh{}ccreating a bag of words model}
         \PY{n}{all\PYZus{}words} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{message} \PY{o+ow}{in} \PY{n}{processed}\PY{p}{:}
             \PY{n}{words} \PY{o}{=} \PY{n}{word\PYZus{}tokenize}\PY{p}{(}\PY{n}{message}\PY{p}{)}
             \PY{k}{for} \PY{n}{w} \PY{o+ow}{in} \PY{n}{words}\PY{p}{:}
                 \PY{n}{all\PYZus{}words}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{w}\PY{p}{)}
         
         \PY{n}{all\PYZus{}words} \PY{o}{=} \PY{n}{nltk}\PY{o}{.}\PY{n}{FreqDist}\PY{p}{(}\PY{n}{all\PYZus{}words}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of words:\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{all\PYZus{}words}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{most common words:\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{all\PYZus{}words}\PY{o}{.}\PY{n}{most\PYZus{}common}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Number of words:6557
most common words:[(u'number', 3072), (u'u', 1207), (u'call', 679), (u'go', 456), (u'get', 451), (u'ur', 391), (u'gt', 318), (u'lt', 316), (u'come', 304), (u'ok', 293), (u'free', 284), (u'day', 276), (u'know', 275), (u'love', 266), (u'like', 261)]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{c+c1}{\PYZsh{}use the 1500 most common words as features}
         \PY{n}{word\PYZus{}features} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{all\PYZus{}words}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{1500}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{c+c1}{\PYZsh{}define a find\PYZus{}feature function}
         \PY{k}{def} \PY{n+nf}{find\PYZus{}feature}\PY{p}{(}\PY{n}{message}\PY{p}{)}\PY{p}{:}
             \PY{n}{words} \PY{o}{=} \PY{n}{word\PYZus{}tokenize}\PY{p}{(}\PY{n}{message}\PY{p}{)}
             \PY{n}{features} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
             \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{word\PYZus{}features}\PY{p}{:}
                 \PY{n}{features}\PY{p}{[}\PY{n}{word}\PY{p}{]}\PY{o}{=}\PY{p}{(}\PY{n}{word} \PY{o+ow}{in} \PY{n}{words}\PY{p}{)}
             \PY{k}{return} \PY{n}{features}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{c+c1}{\PYZsh{}see results}
         \PY{n}{features} \PY{o}{=} \PY{n}{find\PYZus{}feature}\PY{p}{(}\PY{n}{processed}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
         \PY{k}{for} \PY{n}{key}\PY{p}{,}\PY{n}{value} \PY{o+ow}{in} \PY{n}{features}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n}{value} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{:}
                 \PY{k}{print} \PY{n}{key}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
avail
buffet
world
great

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{n}{processed}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}74}]:} u'go jurong point crazi avail bugi n great world la e buffet cine got amor wat'
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{features}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{c+c1}{\PYZsh{}find features for all messages}
         \PY{n}{messages} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{processed}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}define a  seed for reprod\PYZhy{}y}
         \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{1}
         \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed} \PY{o}{=} \PY{n}{seed}
         \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{shuffle}\PY{p}{(}\PY{n}{messages}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}call  find\PYZus{}features function for each sms mesgs}
         \PY{n}{featuresets} \PY{o}{=} \PY{p}{[}\PY{p}{(}\PY{n}{find\PYZus{}feature}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{p}{)} \PY{k}{for} \PY{p}{(}\PY{n}{text}\PY{p}{,}\PY{n}{label}\PY{p}{)} \PY{o+ow}{in} \PY{n}{messages}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{model\PYZus{}selection}
         \PY{n}{training} \PY{p}{,}\PY{n}{testing} \PY{o}{=} \PY{n}{model\PYZus{}selection}\PY{o}{.}\PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{featuresets}\PY{p}{,}\PY{n}{test\PYZus{}size} \PY{o}{=} \PY{l+m+mf}{0.25}\PY{p}{,}\PY{n}{random\PYZus{}state} \PY{o}{=}\PY{n}{seed}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{training:\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{training}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{testing:\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{testing}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
training:4179
testing:1393

    \end{Verbatim}

    \subsection{4.scikitlearn classfiers with
NLTK}\label{scikitlearn-classfiers-with-nltk}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn.neighbors} \PY{k+kn}{import}  \PY{n}{KNeighborsClassifier}
         \PY{k+kn}{from} \PY{n+nn}{sklearn.tree} \PY{k+kn}{import}  \PY{n}{DecisionTreeClassifier}
         \PY{k+kn}{from} \PY{n+nn}{sklearn.ensemble} \PY{k+kn}{import} \PY{n}{RandomForestClassifier}
         \PY{k+kn}{from} \PY{n+nn}{sklearn.linear\PYZus{}model} \PY{k+kn}{import}  \PY{n}{LogisticRegression}\PY{p}{,} \PY{n}{SGDClassifier}
         \PY{k+kn}{from} \PY{n+nn}{sklearn.naive\PYZus{}bayes} \PY{k+kn}{import}  \PY{n}{MultinomialNB}
         \PY{k+kn}{from} \PY{n+nn}{sklearn.svm} \PY{k+kn}{import}  \PY{n}{SVC}
         \PY{k+kn}{from} \PY{n+nn}{sklearn.metrics} \PY{k+kn}{import} \PY{n}{classification\PYZus{}report}\PY{p}{,}\PY{n}{accuracy\PYZus{}score}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{c+c1}{\PYZsh{}define models to train}
         \PY{n}{names} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{K nearest neighbors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Decision tree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Random forest}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logistic regression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SGD classifier}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Naive bayes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SVM linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{classifiers} \PY{o}{=} \PY{p}{[}
             \PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{p}{)}\PY{p}{,} 
             \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{p}{)}\PY{p}{,}
             \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{p}{)}\PY{p}{,}
             \PY{n}{LogisticRegression}\PY{p}{(}\PY{p}{)}\PY{p}{,}
             \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{max\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}\PY{p}{,}
             \PY{n}{MultinomialNB}\PY{p}{(}\PY{p}{)}\PY{p}{,}
             \PY{n}{SVC}\PY{p}{(}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{p}{]}
         \PY{n}{models} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{names}\PY{p}{,} \PY{n}{classifiers}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{k}{print}\PY{p}{(}\PY{n}{models}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[('K nearest neighbors', KNeighborsClassifier(algorithm='auto', leaf\_size=30, metric='minkowski',
           metric\_params=None, n\_jobs=None, n\_neighbors=5, p=2,
           weights='uniform')), ('Decision tree', DecisionTreeClassifier(class\_weight=None, criterion='gini', max\_depth=None,
            max\_features=None, max\_leaf\_nodes=None,
            min\_impurity\_decrease=0.0, min\_impurity\_split=None,
            min\_samples\_leaf=1, min\_samples\_split=2,
            min\_weight\_fraction\_leaf=0.0, presort=False, random\_state=None,
            splitter='best')), ('Random forest', RandomForestClassifier(bootstrap=True, class\_weight=None, criterion='gini',
            max\_depth=None, max\_features='auto', max\_leaf\_nodes=None,
            min\_impurity\_decrease=0.0, min\_impurity\_split=None,
            min\_samples\_leaf=1, min\_samples\_split=2,
            min\_weight\_fraction\_leaf=0.0, n\_estimators='warn', n\_jobs=None,
            oob\_score=False, random\_state=None, verbose=0,
            warm\_start=False)), ('logistic regression', LogisticRegression(C=1.0, class\_weight=None, dual=False, fit\_intercept=True,
          intercept\_scaling=1, max\_iter=100, multi\_class='warn',
          n\_jobs=None, penalty='l2', random\_state=None, solver='warn',
          tol=0.0001, verbose=0, warm\_start=False)), ('SGD classifier', SGDClassifier(alpha=0.0001, average=False, class\_weight=None,
       early\_stopping=False, epsilon=0.1, eta0=0.0, fit\_intercept=True,
       l1\_ratio=0.15, learning\_rate='optimal', loss='hinge', max\_iter=100,
       n\_iter=None, n\_iter\_no\_change=5, n\_jobs=None, penalty='l2',
       power\_t=0.5, random\_state=None, shuffle=True, tol=None,
       validation\_fraction=0.1, verbose=0, warm\_start=False)), ('Naive bayes', MultinomialNB(alpha=1.0, class\_prior=None, fit\_prior=True)), ('SVM linear', SVC(C=1.0, cache\_size=200, class\_weight=None, coef0=0.0,
  decision\_function\_shape='ovr', degree=3, gamma='auto\_deprecated',
  kernel='linear', max\_iter=-1, probability=False, random\_state=None,
  shrinking=True, tol=0.001, verbose=False))]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{c+c1}{\PYZsh{}wrap models in NLTK}
         \PY{k+kn}{from} \PY{n+nn}{nltk.classify.scikitlearn} \PY{k+kn}{import}  \PY{n}{SklearnClassifier}
         \PY{k}{for} \PY{n}{name}\PY{p}{,}\PY{n}{model} \PY{o+ow}{in} \PY{n}{models}\PY{p}{:}
             \PY{n}{nltk\PYZus{}model} \PY{o}{=} \PY{n}{SklearnClassifier}\PY{p}{(}\PY{n}{model}\PY{p}{)}
             \PY{n}{nltk\PYZus{}model}\PY{o}{.}\PY{n}{train}\PY{p}{(}\PY{n}{training}\PY{p}{)}
             \PY{n}{accuracy} \PY{o}{=} \PY{n}{nltk}\PY{o}{.}\PY{n}{classify}\PY{o}{.}\PY{n}{accuracy}\PY{p}{(}\PY{n}{nltk\PYZus{}model}\PY{p}{,}\PY{n}{testing}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100} 
             \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZob{}\PYZcb{}:accuracy:\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{name}\PY{p}{,}\PY{n}{accuracy}\PY{p}{)}\PY{p}{)}
             
             
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
K nearest neighbors:accuracy:94.472361809
Decision tree:accuracy:95.7645369706
Random forest:accuracy:96.2670495334
logistic regression:accuracy:96.7695620962
SGD classifier:accuracy:96.5541995693
Naive bayes:accuracy:95.9798994975
SVM linear:accuracy:96.5541995693

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{c+c1}{\PYZsh{}ensemble method  voting classifier}
         \PY{k+kn}{from} \PY{n+nn}{sklearn.ensemble} \PY{k+kn}{import}  \PY{n}{VotingClassifier}
         \PY{c+c1}{\PYZsh{}define models to train}
         \PY{k+kn}{from} \PY{n+nn}{nltk.classify.scikitlearn} \PY{k+kn}{import}  \PY{n}{SklearnClassifier}
         \PY{k}{for} \PY{n}{name}\PY{p}{,}\PY{n}{model} \PY{o+ow}{in} \PY{n}{models}\PY{p}{:}
             \PY{n}{nltk\PYZus{}model} \PY{o}{=} \PY{n}{SklearnClassifier}\PY{p}{(}\PY{n}{model}\PY{p}{)}
             \PY{n}{nltk\PYZus{}model}\PY{o}{.}\PY{n}{train}\PY{p}{(}\PY{n}{training}\PY{p}{)}
             \PY{n}{accuracy} \PY{o}{=} \PY{n}{nltk}\PY{o}{.}\PY{n}{classify}\PY{o}{.}\PY{n}{accuracy}\PY{p}{(}\PY{n}{nltk\PYZus{}model}\PY{p}{,}\PY{n}{testing}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100} 
             \PY{c+c1}{\PYZsh{}print(\PYZsq{}\PYZob{}\PYZcb{}:accuracy:\PYZob{}\PYZcb{}\PYZsq{}.format(name,accuracy))}
         
         \PY{n}{models} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{names}\PY{p}{,}\PY{n}{classifiers}\PY{p}{)}
         \PY{n}{nltk\PYZus{}ensemble} \PY{o}{=} \PY{n}{SklearnClassifier}\PY{p}{(}\PY{n}{VotingClassifier}\PY{p}{(}\PY{n}{estimators} \PY{o}{=} \PY{n}{models}\PY{p}{,}\PY{n}{voting}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{nltk\PYZus{}ensemble}\PY{o}{.}\PY{n}{train}\PY{p}{(}\PY{n}{training}\PY{p}{)}
         \PY{n}{accuracy} \PY{o}{=} \PY{n}{nltk}\PY{o}{.}\PY{n}{classify}\PY{o}{.}\PY{n}{accuracy}\PY{p}{(}\PY{n}{nltk\PYZus{}ensemble}\PY{p}{,}\PY{n}{testing}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ensemble method accuracy :\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{accuracy}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
ensemble method accuracy :96.9131371141

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}95}]:} \PY{c+c1}{\PYZsh{}make class label prediction foro testing set}
         \PY{n}{txt\PYZus{}features}\PY{p}{,}\PY{n}{labels} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{n}{testing}\PY{p}{)}
         \PY{n}{prediction} \PY{o}{=} \PY{n}{nltk\PYZus{}ensemble}\PY{o}{.}\PY{n}{classify\PYZus{}many}\PY{p}{(}\PY{n}{txt\PYZus{}features}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}96}]:} \PY{c+c1}{\PYZsh{}print a confusion matrix \PYZam{} a classification report}
         \PY{k}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{labels}\PY{p}{,}\PY{n}{prediction}\PY{p}{)}\PY{p}{)}
         \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
         \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{labels}\PY{p}{,}\PY{n}{prediction}\PY{p}{)}\PY{p}{,}
         \PY{n}{index} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{actual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{actual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ham}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,}
         \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ham}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

           0       0.97      1.00      0.98      1213
           1       0.98      0.78      0.87       180

   micro avg       0.97      0.97      0.97      1393
   macro avg       0.97      0.89      0.92      1393
weighted avg       0.97      0.97      0.97      1393


    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}96}]:}             predicted     
                           ham spam
         actual ham       1210    3
                spam        40  140
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
